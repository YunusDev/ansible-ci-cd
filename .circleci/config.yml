version: 2.1
jobs:
    configure_infrastructure:
        docker: 
            - image: python:3.7-alpine3.11

        steps:
            - checkout
            - add_ssh_keys:
                fingerprints: 
                    - "32:4d:04:cc:69:1d:23:c5:0f:0d:b7:fb:25:a0:3e:5f"
                    - "64:7f:3d:c7:e9:66:11:7d:44:95:2f:c4:a8:ce:4f:7c"
            - run:
                name: Install Dependencies
                command: |
                    apk add --update ansible
                
            - run:
                name: Configure server
                command: |
                    ansible-playbook main-remote.yml -i inventory 
workflows:
    my_work_flow:
        jobs:
            - configure_infrastructure